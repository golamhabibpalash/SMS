@model SMS.App.ViewModels.AdministrationVM.RegisterVM

@{
    ViewBag.Title = "User Registration";
    Layout = "~/Views/Shared/_LoginLayout.cshtml";
    char userType = ' ';
    string user = "New User";
    if (ViewBag.user!=null)
    {
        user = ViewBag.user;
    }
    if (ViewBag.userType!=null)
    {
        userType = ViewBag.userType;
    }
}


<div class="row m-5">
    <div class="col-md-8 offset-md-2">
        <div class="card ">
            <div class="card-header text-center">
                <h4>@user registration</h4>
            </div>
            <form class="p-3" method="post" asp-action="Register">
                <div asp-validation-summary="All" class="text-danger"></div>
                <input type="hidden" asp-for="UserType" value="@ViewBag.userType" />
                <div class="form-group row">
                    <label asp-for="ReferenceId" class="control-label col-form-label col-md-3 text-md-right"></label>
                    <div class="col-md-9">
                        <select asp-for="ReferenceId" class="form-control" asp-items="@ViewBag.userList">
                            <option selected disabled>-Select User-</option>
                        </select>
                        <span asp-validation-for="ReferenceId" class="text-danger"></span>
                    </div>
                </div>
                <div id="registerDetail" style="display:none">
                    <div class="form-group row">
                        <label asp-for="Email" class="col-form-label col-md-3 text-md-right"></label>
                        <div class="col-md-9">
                            <input asp-for="Email" class="form-control" readonly />
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label asp-for="Phone" class="col-form-label col-md-3 text-md-right"></label>
                        <div class="col-md-9">
                            <input asp-for="Phone" class="form-control" />
                            <span asp-validation-for="Phone" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label asp-for="Password" class="col-form-label col-md-3 text-md-right"></label>
                        <div class="col-md-9">
                            <input asp-for="Password" class="form-control" />
                            <span asp-validation-for="Password" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label asp-for="ConfirmPassword" class="col-form-label col-md-3 text-md-right"></label>
                        <div class="col-md-9">
                            <input asp-for="ConfirmPassword" class="form-control" />
                            <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-12 text-center">
                            <button type="submit" class="btn btn-primary">Register</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    <span>Already registerd! <a class="btn btn-sm btn-outline-info" asp-action="login" asp-controller="Accounts" asp-route-userType="@ViewBag.userType">Login</a></span>
                </div>
            </form>

        </div>
    </div>
</div>

@section Scripts{ 
<script>
    $(document).ready(function () {
        $('#ReferenceId').change(function () {
            let userId = $(this).val();
            let userType = '@ViewBag.userType';
            $.ajax({
                url: "/Accounts/GetUserById",
                data: { id: userId, type: userType },
                type: 'JSON',
                method: 'POST',
                success: function (data) {
                    $('#registerDetail').css('display','block');
                    $('#Email').val(data.email);
                    $('#Phone').val(data.phone);
                },
                error: function (err) {
                    console.log(err);
                }
            });
        });
    });
</script>
}